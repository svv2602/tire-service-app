# Проблемы с API временных слотов

## Проблема

В приложении возникали ошибки 500 при попытке получить доступные временные слоты через эндпоинт:
```
/api/v2/service-points/{servicePointId}/available-time-slots?date=YYYY-MM-DD
```

## Решение

Мы реализовали многоуровневый подход к решению этой проблемы:

1. **Мультиадресация API**:
   - Функция `getAvailableTimeSlots` теперь пробует несколько форматов URL в определенном порядке:
     - `/api/service-points/{servicePointId}/available-slots/{date}`
     - `/api/v2/service-points/{servicePointId}/available-slots/{date}`
     - `/api/service-points/{servicePointId}/available-time-slots?date={date}`
     - `/api/v2/service-points/{servicePointId}/available-time-slots?date={date}`

2. **Механизм резервного копирования**:
   - Если все API-запросы не удалось выполнить, создается набор стандартных временных слотов
   - Это гарантирует, что пользователи всегда смогут выбрать время встречи

3. **Улучшенная журнализация**:
   - Подробное логирование всех попыток запросов API
   - Четкие сообщения об ошибках для облегчения отладки

4. **Диагностический инструмент**:
   - Создан инструмент тестирования `test-timeslots-api.js` для проверки всех возможных URL-путей
   - Запускается через `test-timeslots.bat`

## Как это работает

Когда приложение пытается получить временные слоты, оно:
1. Пробует несколько возможных форматов API URL последовательно
2. Использует первый успешный ответ
3. В случае ошибок во всех запросах, генерирует временные слоты по умолчанию (с 9:00 до 18:00)

## Действия для бэкэнд-команды

Для окончательного решения этой проблемы рекомендуется:
1. Проверить и исправить обработку маршрутов `available-slots` и `available-time-slots` на сервере
2. Стандартизировать формат API для временных слотов (параметр запроса или URL-сегмент)
3. Обработать ошибки в контроллере `AppointmentController::getAvailableTimeSlots`

## Мониторинг

Воспользуйтесь инструментом `test-timeslots-api.js` для проверки работоспособности API временных слотов на различных окружениях.
